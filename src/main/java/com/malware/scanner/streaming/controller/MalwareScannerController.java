package com.malware.scanner.streaming.controller;

import com.malware.scanner.streaming.model.CheckEvent;
import com.malware.scanner.streaming.model.CheckResultEvent;
import com.malware.scanner.streaming.service.MalwareScannerService;
import lombok.RequiredArgsConstructor;
import lombok.extern.log4j.Log4j2;
import org.springframework.web.bind.annotation.PostMapping;
import org.springframework.web.bind.annotation.RequestBody;
import org.springframework.web.bind.annotation.RequestMapping;
import org.springframework.web.bind.annotation.RestController;

import java.util.List;

@Log4j2
@RestController
@RequiredArgsConstructor
@RequestMapping("/api/v1")
public class MalwareScannerController {
    private final MalwareScannerService malwareScannerService;

    @PostMapping("malwareScanner")
    public List<CheckResultEvent> scan(@RequestBody final CheckEvent checkEvent) {
        log.info("Entering to MalwareScannerController.scan() called with payload: {}", checkEvent);
        return malwareScannerService.performScan(checkEvent);
    }
}
