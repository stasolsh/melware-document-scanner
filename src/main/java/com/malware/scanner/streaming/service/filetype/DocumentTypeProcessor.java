package com.malware.scanner.streaming.service.filetype;

import com.malware.scanner.streaming.model.CheckEvent;
import com.malware.scanner.streaming.model.CheckResultEvent;
import com.malware.scanner.streaming.model.FileType;
import com.malware.scanner.streaming.service.checks.Check;
import org.springframework.beans.factory.annotation.Autowired;

import java.util.List;

public interface DocumentTypeProcessor {
    CheckResultEvent verify(final CheckEvent checkEvent, final String name);

    FileType getDocType();

    @Autowired
    default void registryMyself(List<Check> checks) {
        checks.forEach(check -> check.register(getDocType(), this));
    }
}
