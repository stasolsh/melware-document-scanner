package com.malware.scanner.streaming.service.checks;

import com.malware.scanner.streaming.model.CheckEvent;
import com.malware.scanner.streaming.model.CheckResultEvent;
import com.malware.scanner.streaming.model.FileType;
import org.junit.jupiter.api.Test;
import org.junit.jupiter.api.extension.ExtendWith;
import org.mockito.InjectMocks;
import org.springframework.test.context.junit.jupiter.SpringExtension;

import static com.malware.scanner.streaming.model.CheckResultEvent.StateEnum.IGNORED;
import static org.junit.jupiter.api.Assertions.assertEquals;

@ExtendWith(SpringExtension.class)
public class CheckMagicByteServiceTest {
    private static final String MAGIC_BYTE_CHECK = "MAGIC_BYTE_CHECK";
    private static final String TEST_URL = "test_url";
    private static final String DETAILS = "Not Implemented Yet!";
    @InjectMocks
    private CheckMagicByteService checkMagicByteService;

    @Test
    public void performScan() {
        //when
        CheckResultEvent result = checkMagicByteService.performScan(getCheckEvent());

        //then
        assertEquals(MAGIC_BYTE_CHECK, result.getName());
        assertEquals(DETAILS, result.getDetails());
        assertEquals(IGNORED, result.getState());
    }

    @Test
    public void shouldReturnServiceName() {
        //then
        assertEquals(MAGIC_BYTE_CHECK, checkMagicByteService.getName());
    }

    private static CheckEvent getCheckEvent() {
        return new CheckEvent()
                .setFileType(FileType.PDF)
                .setUrl(TEST_URL);
    }
}